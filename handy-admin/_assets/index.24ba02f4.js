let e=document.createElement("style");e.innerHTML="",document.head.appendChild(e);import{a,m as t,I as o,q as l,M as n,s as i,f as r,v as s,r as c,o as d,c as m,i as u,x as f,w as p,b}from"./index.fb302126.js";import{s as y,g as v,u as g,a as h,d as w,b as k,c as I,e as O,f as S,h as F}from"./SchemaForm.df663f5b.js";var C={icon:{tag:"svg",attrs:{viewBox:"64 64 896 896",focusable:"false"},children:[{tag:"path",attrs:{d:"M512 64C264.6 64 64 264.6 64 512s200.6 448 448 448 448-200.6 448-448S759.4 64 512 64zm0 820c-205.4 0-372-166.6-372-372s166.6-372 372-372 372 166.6 372 372-166.6 372-372 372z"}},{tag:"path",attrs:{d:"M623.6 316.7C593.6 290.4 554 276 512 276s-81.6 14.5-111.6 40.7C369.2 344 352 380.7 352 420v7.6c0 4.4 3.6 8 8 8h48c4.4 0 8-3.6 8-8V420c0-44.1 43.1-80 96-80s96 35.9 96 80c0 31.1-22 59.6-56.1 72.7-21.2 8.1-39.2 22.3-52.1 40.9-13.1 19-19.9 41.8-19.9 64.9V620c0 4.4 3.6 8 8 8h48c4.4 0 8-3.6 8-8v-22.7a48.3 48.3 0 0130.9-44.8c59-22.7 97.1-74.7 97.1-132.5.1-39.3-17.1-76-48.3-103.3zM472 732a40 40 0 1080 0 40 40 0 10-80 0z"}}]},name:"question-circle",theme:"outlined"};function x(e,a,t){return a in e?Object.defineProperty(e,a,{value:t,enumerable:!0,configurable:!0,writable:!0}):e[a]=t,e}var L=function(e,l){var n=function(e){for(var a=1;a<arguments.length;a++){var t=null!=arguments[a]?Object(arguments[a]):{},o=Object.keys(t);"function"==typeof Object.getOwnPropertySymbols&&(o=o.concat(Object.getOwnPropertySymbols(t).filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable})))),o.forEach((function(a){x(e,a,t[a])}))}return e}({},e,l.attrs);return a(o,t(n,{icon:C}),null)};L.displayName="QuestionCircleOutlined",L.inheritAttrs=!1;const R={style:{width:"auto"},formItemLayout:{labelCol:{span:4},wrapperCol:{span:20}},formItem:[{type:"input",label:"用户名",field:"name",value:"",props:{disabled:!0,placeholder:"请输入用户名"},rules:[{required:!0,message:"用户名不能为空"}]},{type:"checkbox",label:"角色",field:"roles",value:[],options:[],loading:!0,asyncOptions:async()=>(await v()).result.records.map((e=>({label:e.roleName,value:e.roleId})))}]};var j=l({name:"edit-modal",components:{[n.name]:n,SchemaForm:y},props:{remove:{type:Function},fields:{type:Object},callback:{type:Function}},setup(e){const a=i(null),t=r({visible:!0,confirmLoading:!1,dynamicValidateForm:R});return{...s(t),handleOk:async()=>{t.confirmLoading=!0,a.value.validate().then((async o=>{const{username:l,roles:n}=a.value.modelRef;n.toString(),await g(h(e.fields?.id),{ref:t,loadingName:"confirmLoading"});t.visible=!1,e.callback&&e.callback()})).catch((e=>{console.log("error",e),t.confirmLoading=!1}))},dynamicForm:a}}});const _=u("data-v-c0e3e118"),K=_((function(e,t,o,l,n,i){const r=c("SchemaForm"),s=c("a-modal");return d(),m(s,{title:"编辑账号",visible:e.visible,"onUpdate:visible":t[1]||(t[1]=a=>e.visible=a),"confirm-loading":e.confirmLoading,afterClose:e.remove,onOk:e.handleOk},{default:_((()=>[a(r,{ref:"dynamicForm",fields:{...e.fields,roles:e.fields?.roleId},"dynamic-validate-form":e.dynamicValidateForm},null,8,["fields","dynamic-validate-form"])])),_:1},8,["visible","confirm-loading","afterClose","onOk"])}));j.render=K,j.__scopeId="data-v-c0e3e118";const T=[{title:"用户名",dataIndex:"name"},{title:"账户",dataIndex:"account"},{title:"手机号",dataIndex:"phone"},{title:"邮箱",dataIndex:"email"},{title:"状态",dataIndex:"status"},{title:"创建时间",dataIndex:"createTime",slots:{customRender:"createTime"},slotsType:"format",slotsFunc:e=>e},{title:"操作",dataIndex:"action",width:200,slots:{customRender:"action"},actions:[{type:"popconfirm",key:"fileid",text:"删除",permission:{action:"delete",effect:"disabled"},props:{type:"danger"},func:async({record:e},a)=>{await w(e.userId),a()}},{type:"button",key:"fileid",text:"编辑",props:{type:"warning"},func:({record:e},a)=>k(j,{fields:e,callback:a})}]}],P={formItem:[{type:"input",label:"用户名",field:"username",value:"",props:{placeholder:"请输入用户名"},rules:[{required:!0,message:"用户名不能为空"}]},{type:"input",label:"密码",field:"password",value:"",props:{type:"password",placeholder:"请输入密码"},rules:[{required:!0,message:"密码不能为空"}]},{type:"checkbox",label:"角色",field:"roles",value:[],options:[],loading:!0,asyncOptions:async()=>(await v()).result.records.map((e=>({label:e.roleName,value:e.roleId})))}]};var V=l({name:"add-modal",components:{[n.name]:n,SchemaForm:y},props:{remove:{type:Function},callback:{type:Function}},setup(e){const a=i(null),t=r({visible:!0,confirmLoading:!1,dynamicValidateForm:P});return{...s(t),handleOk:()=>{t.confirmLoading=!0,a.value.validate().then((async o=>{const l={...a.value.modelRef,roles:a.value.modelRef.roles.toString()};await g(I(l),{ref:t,loadingName:"confirmLoading"}),t.visible=!1,e.callback&&e.callback()})).catch((e=>{console.log("error",e),t.confirmLoading=!1}))},dynamicForm:a}}});const q=u("data-v-0afa3e23"),M=q((function(e,t,o,l,n,i){const r=c("SchemaForm"),s=c("a-modal");return d(),m(s,{title:"新增账号",visible:e.visible,"onUpdate:visible":t[1]||(t[1]=a=>e.visible=a),"confirm-loading":e.confirmLoading,afterClose:e.remove,onOk:e.handleOk},{default:q((()=>[a(r,{ref:"dynamicForm","dynamic-validate-form":e.dynamicValidateForm},null,8,["dynamic-validate-form"])])),_:1},8,["visible","confirm-loading","afterClose","onOk"])}));V.render=M,V.__scopeId="data-v-0afa3e23";var N=l({components:{BasicTable:O},setup(){const e=i(null),t=r({data:[],uploading:!1,tableLoading:!1,rowSelection:{onChange:(e,a)=>{t.rowSelection.selectedRowKeys=e},selectedRowKeys:[]}}),o=f((()=>0==t.rowSelection.selectedRowKeys.length));return{...s(t),tableRef:e,columns:T,getUserPage:S,isDisabled:o,addItem:()=>{k(V,{callback:()=>{}})},deleteItems:()=>{console.log(t.rowSelection.selectedRowKeys.toString()),n.confirm({title:"提示",icon:a(L),content:"您确定要删除所有选中吗？",onOk:async()=>{await F(t.rowSelection.selectedRowKeys.toString()),e.value.refreshTableData(),t.rowSelection.selectedRowKeys=[]}})}}}});const z={class:"content"},D=b("添加"),U=b("删除");N.render=function(e,t,o,l,n,i){const r=c("a-button"),s=c("BasicTable");return d(),m("div",z,[a(s,{ref:"tableRef",columns:e.columns,"get-list-func":e.getUserPage,rowKey:"userId","row-selection":e.rowSelection},{title:p((()=>[a(r,{onClick:e.addItem,type:"primary"},{default:p((()=>[D])),_:1},8,["onClick"]),a(r,{onClick:e.deleteItems,disabled:e.isDisabled,type:"primary"},{default:p((()=>[U])),_:1},8,["onClick","disabled"])])),_:1},8,["columns","get-list-func","row-selection"])])};export default N;
