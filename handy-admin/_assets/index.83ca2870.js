let e=document.createElement("style");e.innerHTML="",document.head.appendChild(e);import{q as a,M as o,s as l,f as t,v as n,r as i,o as s,c as r,a as d,i as c,x as m,w as u,b as f}from"./index.a841be5a.js";import{s as p,g as y,u as b,a as v,d as g,b as h,c as w,e as k,f as I,Q as F,h as x}from"./SchemaForm.022d367d.js";const S={style:{width:"auto"},formItemLayout:{labelCol:{span:4},wrapperCol:{span:20}},formItem:[{type:"input",label:"用户名",field:"name",value:"",props:{disabled:!0,placeholder:"请输入用户名"},rules:[{required:!0,message:"用户名不能为空"}]},{type:"checkbox",label:"角色",field:"roles",value:[],options:[],loading:!0,asyncOptions:async()=>(await y()).result.records.map((e=>({label:e.roleName,value:e.roleId})))}]};var L=a({name:"edit-modal",components:{[o.name]:o,SchemaForm:p},props:{remove:{type:Function},fields:{type:Object},callback:{type:Function}},setup(e){const a=l(null),o=t({visible:!0,confirmLoading:!1,dynamicValidateForm:S});return{...n(o),handleOk:async()=>{o.confirmLoading=!0,a.value.validate().then((async l=>{const{username:t,roles:n}=a.value.modelRef;n.toString(),await b(v(e.fields?.id),{ref:o,loadingName:"confirmLoading"});o.visible=!1,e.callback&&e.callback()})).catch((e=>{console.log("error",e),o.confirmLoading=!1}))},dynamicForm:a}}});const C=c("data-v-c0e3e118"),O=C((function(e,a,o,l,t,n){const c=i("SchemaForm"),m=i("a-modal");return s(),r(m,{title:"编辑账号",visible:e.visible,"onUpdate:visible":a[1]||(a[1]=a=>e.visible=a),"confirm-loading":e.confirmLoading,afterClose:e.remove,onOk:e.handleOk},{default:C((()=>[d(c,{ref:"dynamicForm",fields:{...e.fields,roles:e.fields?.roleId},"dynamic-validate-form":e.dynamicValidateForm},null,8,["fields","dynamic-validate-form"])])),_:1},8,["visible","confirm-loading","afterClose","onOk"])}));L.render=O,L.__scopeId="data-v-c0e3e118";const R=[{title:"用户名",dataIndex:"name"},{title:"账户",dataIndex:"account"},{title:"手机号",dataIndex:"phone"},{title:"邮箱",dataIndex:"email"},{title:"状态",dataIndex:"status"},{title:"创建时间",dataIndex:"createTime",slots:{customRender:"createTime"},slotsType:"format",slotsFunc:e=>e},{title:"操作",dataIndex:"action",width:200,slots:{customRender:"action"},actions:[{type:"popconfirm",key:"fileid",text:"删除",permission:{action:"delete",effect:"disabled"},props:{type:"danger"},func:async({record:e},a)=>{await g(e.userId),a()}},{type:"button",key:"fileid",text:"编辑",props:{type:"warning"},func:({record:e},a)=>h(L,{fields:e,callback:a})}]}],_={formItem:[{type:"input",label:"用户名",field:"username",value:"",props:{placeholder:"请输入用户名"},rules:[{required:!0,message:"用户名不能为空"}]},{type:"input",label:"密码",field:"password",value:"",props:{type:"password",placeholder:"请输入密码"},rules:[{required:!0,message:"密码不能为空"}]},{type:"checkbox",label:"角色",field:"roles",value:[],options:[],loading:!0,asyncOptions:async()=>(await y()).result.records.map((e=>({label:e.roleName,value:e.roleId})))}]};var T=a({name:"add-modal",components:{[o.name]:o,SchemaForm:p},props:{remove:{type:Function},callback:{type:Function}},setup(e){const a=l(null),o=t({visible:!0,confirmLoading:!1,dynamicValidateForm:_});return{...n(o),handleOk:()=>{o.confirmLoading=!0,a.value.validate().then((async l=>{const t={...a.value.modelRef,roles:a.value.modelRef.roles.toString()};await b(w(t),{ref:o,loadingName:"confirmLoading"}),o.visible=!1,e.callback&&e.callback()})).catch((e=>{console.log("error",e),o.confirmLoading=!1}))},dynamicForm:a}}});const K=c("data-v-0afa3e23"),q=K((function(e,a,o,l,t,n){const c=i("SchemaForm"),m=i("a-modal");return s(),r(m,{title:"新增账号",visible:e.visible,"onUpdate:visible":a[1]||(a[1]=a=>e.visible=a),"confirm-loading":e.confirmLoading,afterClose:e.remove,onOk:e.handleOk},{default:K((()=>[d(c,{ref:"dynamicForm","dynamic-validate-form":e.dynamicValidateForm},null,8,["dynamic-validate-form"])])),_:1},8,["visible","confirm-loading","afterClose","onOk"])}));T.render=q,T.__scopeId="data-v-0afa3e23";var N=a({components:{BasicTable:k},setup(){const e=l(null),a=t({data:[],uploading:!1,tableLoading:!1,rowSelection:{onChange:(e,o)=>{a.rowSelection.selectedRowKeys=e},selectedRowKeys:[]}}),i=m((()=>0==a.rowSelection.selectedRowKeys.length));return{...n(a),tableRef:e,columns:R,getUserPage:I,isDisabled:i,addItem:()=>{h(T,{callback:()=>{}})},deleteItems:()=>{o.confirm({title:"提示",icon:d(F),content:"您确定要删除所有选中吗？",onOk:async()=>{await x(a.rowSelection.selectedRowKeys.toString()),e.value.refreshTableData(),a.rowSelection.selectedRowKeys=[]}})}}}});const U={class:"content"},V=f("添加"),j=f("删除");N.render=function(e,a,o,l,t,n){const c=i("a-button"),m=i("BasicTable");return s(),r("div",U,[d(m,{ref:"tableRef",columns:e.columns,"get-list-func":e.getUserPage,rowKey:"userId","row-selection":e.rowSelection},{title:u((()=>[d(c,{onClick:e.addItem,type:"primary"},{default:u((()=>[V])),_:1},8,["onClick"]),d(c,{onClick:e.deleteItems,disabled:e.isDisabled,type:"primary"},{default:u((()=>[j])),_:1},8,["onClick","disabled"])])),_:1},8,["columns","get-list-func","row-selection"])])};export default N;
